@page
@model RealEstatePMP.Pages.Dwellings.SearchModel

@{
    ViewData["Title"] = "Search";
}

<h1>Search Dwellings</h1>

<div class="row">
    <div class="col">
        <form action="" method="get" class="form-inline">
            <input asp-for="Query" class="form-control mr-sm-2 mb-2" placeholder="Search City..." />
            <button type="submit" class="btn btn-primary mb-2">Search</button>
        </form>

    </div>

</div>

@if (Model.SearchCompleted)
{
    if (Model.Dwelling.Any())
    {


        <table class="table">
            <thead>
                <tr>
                    <th>
                        @Html.DisplayNameFor(model => model.Dwelling[0].BuildingName)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Dwelling[0].FullAddress)
                    </th>
                    <!-- Hiding separeate columns for address and making it in one column with full address
    <th>
        @Html.DisplayNameFor(model => model.Dwelling[0].ApartmentNumber)
    </th>
    <th>
        @Html.DisplayNameFor(model => model.Dwelling[0].Street)
    </th>
    <th>
        @Html.DisplayNameFor(model => model.Dwelling[0].CityName)
    </th>
    <th>
        @Html.DisplayNameFor(model => model.Dwelling[0].State)
    </th>
    <th>
        @Html.DisplayNameFor(model => model.Dwelling[0].ZipCode)
    </th>
    -->
                    <th>
                        @Html.DisplayNameFor(model => model.Dwelling[0].Description)
                    </th>

                    <!-- Hiding unwanted columns from display
    <th>
        @Html.DisplayNameFor(model => model.Dwelling[0].NoOfBed)
    </th>
    <th>
        @Html.DisplayNameFor(model => model.Dwelling[0].NoOfBath)
    </th>
    <th>
        @Html.DisplayNameFor(model => model.Dwelling[0].Dishwasher)
    </th>
    <th>
        @Html.DisplayNameFor(model => model.Dwelling[0].Laundry)
    </th>
    <th>
        @Html.DisplayNameFor(model => model.Dwelling[0].Parking)
    </th>

    <th>
        @Html.DisplayNameFor(model => model.Dwelling[0].UtilitiesIncluded)
    </th>
    <th>
        @Html.DisplayNameFor(model => model.Dwelling[0].RentPerMonth)
    </th>
     <th>
        @Html.DisplayNameFor(model => model.Dwelling[0].City)
    </th>
    End of hide -->
                    <th>
                        @Html.DisplayNameFor(model => model.Dwelling[0].Availability)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Dwelling[0].AvailableDate)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Dwelling[0].Price)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Dwelling[0].Agent)
                    </th>


                    <th></th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model.Dwelling)
                {
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.BuildingName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.FullAddress)
                    </td>
                    <!-- Hiding separate fields of address and making them into one
    <td>
        @Html.DisplayFor(modelItem => item.ApartmentNumber)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.Street)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.CityName)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.State)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.ZipCode)
    </td>
     end of hide -->
                    <td>
                        @Html.DisplayFor(modelItem => item.Description)
                    </td>
                    <!-- Hiding unwanted data from index
    <td>
        @Html.DisplayFor(modelItem => item.NoOfBed)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.NoOfBath)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.Dishwasher)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.Laundry)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.Parking)
    </td>
    <td>
        @Html.DisplayFor(modelItem => item.UtilitiesIncluded)
    </td>
         <td>
        @Html.DisplayFor(modelItem => item.RentPerMonth)
    </td>
        <td>
        @Html.DisplayFor(modelItem => item.City.Name)
    </td>
     End of hide -->
                    <td>
                        @if (item.Availability == true)
                        {
                            <span class="badge badge-success">Available</span>
                        }
                        else
                        {
                            <span class="badge badge-secondary">Sold out</span>
                        }
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.AvailableDate)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Price)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Agent.FullName)
                    </td>


                    <td>
                        
                        <a asp-page="./Details" asp-route-id="@item.DwellingId">Details</a> 
                      
                    </td>
                </tr>
                }
            </tbody>
        </table>


    }
    else
    {
        <div class="row">
            <div class="col">
                <div class="alert alert-info">
                    No results match your term <strong>@Model.Query</strong>
                </div>
            </div>
        </div>
    }

}

else
{
    <div class="row">
        <div class="col">
            <div class="alert alert-info">
                No results match your term <strong>@Model.Query</strong>
            </div>
        </div>
    </div>
}
